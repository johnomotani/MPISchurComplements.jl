<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>MPISchurComplements.jl · MPISchurComplements</title><meta name="title" content="MPISchurComplements.jl · MPISchurComplements"/><meta property="og:title" content="MPISchurComplements.jl · MPISchurComplements"/><meta property="twitter:title" content="MPISchurComplements.jl · MPISchurComplements"/><meta name="description" content="Documentation for MPISchurComplements."/><meta property="og:description" content="Documentation for MPISchurComplements."/><meta property="twitter:description" content="Documentation for MPISchurComplements."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>MPISchurComplements</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>MPISchurComplements.jl</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>MPISchurComplements.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>MPISchurComplements.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/johnomotani/MPISchurComplements.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/johnomotani/MPISchurComplements.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="MPISchurComplements.jl"><a class="docs-heading-anchor" href="#MPISchurComplements.jl">MPISchurComplements.jl</a><a id="MPISchurComplements.jl-1"></a><a class="docs-heading-anchor-permalink" href="#MPISchurComplements.jl" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MPISchurComplements.MPISchurComplements" href="#MPISchurComplements.MPISchurComplements"><code>MPISchurComplements.MPISchurComplements</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Use the Schur complement technique to solve a block-2x2 matrix system, parallelised with MPI.</p><p>Solve the matrix system</p><p class="math-container">\[\left(\begin{array}{cc}
A &amp; B\\
C &amp; D
\end{array}\right)
\cdot\left(\begin{array}{c}
x\\
y
\end{array}\right)
=\left(\begin{array}{c}
u\\
v
\end{array}\right)\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/johnomotani/MPISchurComplements.jl/blob/765576e9166e4412b23d3c7766dfe5ca9a60751a/src/MPISchurComplements.jl#L1-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LinearAlgebra.ldiv!-Tuple{AbstractVector, AbstractVector, MPISchurComplement, AbstractVector, AbstractVector}" href="#LinearAlgebra.ldiv!-Tuple{AbstractVector, AbstractVector, MPISchurComplement, AbstractVector, AbstractVector}"><code>LinearAlgebra.ldiv!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ldiv!(x::AbstractVector, y::AbstractVector, sc::MPISchurComplement,
      u::AbstractVector, v::AbstractVector)</code></pre><p>Solve the 2x2 block-structured matrix system</p><p class="math-container">\[\left(\begin{array}{cc}
A &amp; B\\
C &amp; D
\end{array}\right)
\cdot
\left(\begin{array}{c}
x\\
y
\end{array}\right)
=
\left(\begin{array}{c}
u\\
v
\end{array}\right)\]</p><p>for <span>$x$</span> and <span>$v$</span>.</p><p>Only the locally owned parts of <code>u</code> and <code>v</code> should be passed, and the locally owned parts of the solution will be written into <code>x</code> and <code>y</code>. This means that <code>x</code> and <code>u</code> should correspond to the global indices in <code>sc.owned_top_vector_entries</code> and <code>y</code> and <code>v</code> should correspond to the global indices in <code>sc.owned_bottom_vector_entries</code>. When shared memory is used, <code>x</code> and <code>y</code> must be shared-memory arrays (identical on every process in <code>sc.shared_comm</code>). <code>u</code> and <code>v</code> should also be shared memory arrays (although non-shared identical copies would also work).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/johnomotani/MPISchurComplements.jl/blob/765576e9166e4412b23d3c7766dfe5ca9a60751a/src/MPISchurComplements.jl#L534-L564">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MPISchurComplements.get_neighbour_comms-Tuple{MPI.Comm}" href="#MPISchurComplements.get_neighbour_comms-Tuple{MPI.Comm}"><code>MPISchurComplements.get_neighbour_comms</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get communicators which include this rank and one neighbouring rank.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/johnomotani/MPISchurComplements.jl/blob/765576e9166e4412b23d3c7766dfe5ca9a60751a/src/MPISchurComplements.jl#L68-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MPISchurComplements.mpi_schur_complement-Tuple{Any, AbstractMatrix, UnitRange{Int64}, AbstractMatrix, UnitRange{Int64}, AbstractMatrix, UnitRange{Int64}, UnitRange{Int64}, UnitRange{Int64}}" href="#MPISchurComplements.mpi_schur_complement-Tuple{Any, AbstractMatrix, UnitRange{Int64}, AbstractMatrix, UnitRange{Int64}, AbstractMatrix, UnitRange{Int64}, UnitRange{Int64}, UnitRange{Int64}}"><code>MPISchurComplements.mpi_schur_complement</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mpi_schur_complement(A_factorization, B::AbstractMatrix,
                     B_global_column_range::UnitRange{Int64}, C::AbstractMatrix,
                     C_global_row_range::UnitRange{Int64}, D::AbstractMatrix,
                     D_global_column_range::UnitRange{Int64},
                     owned_top_vector_entries::UnitRange{Int64},
                     owned_bottom_vector_entries::UnitRange{Int64};
                     distributed_comm::MPI.Comm=MPI.COMM_SELF,
                     shared_comm::Union{MPI.Comm,Nothing}=nothing,
                     allocate_array::Union{Function,Nothing}=nothing)</code></pre><p>Initialise an MPISchurComplement struct representing a 2x2 block-structured matrix</p><p class="math-container">\[\left(\begin{array}{cc}
A &amp; B\\
C &amp; D
\end{array}\right)\]</p><p><code>A_factorization</code> should be a matrix factorization of <code>A</code>, or an object with similar functionality, that can be passed to the <code>ldiv!()</code> function to solve a matrix system.</p><p><code>B</code> and <code>D</code> are only used to initialize the MPISchurComplement, they are not stored. A reference to <code>C</code> is stored. Only the locally owned parts of <code>B</code>, <code>C</code> and <code>D</code> should be passed. <code>B</code>, <code>C</code> and <code>D</code> may be modified by this function. <code>owned_top_vector_entries</code> gives the range of global indices that are owned by this process in the top block of the state vector, <code>owned_bottom_vector_entries</code> the same for the bottom block. <code>B</code> should contain only the rows corresponding to <code>owned_top_vector_entries</code> and the columns corresponding to the global indices given by <code>B_global_column_range</code> (these do not have to be all the global indices, when it is known that the locally owned rows of <code>B</code> are zero outside of <code>B_global_column_range</code>). <code>C</code> should contain only the columns corresponding to <code>owned_top_vector_entries</code> and the rows corresponding to the global indices given by <code>C_global_row_range</code> (these do not have to be all the global indices, when it is known that the locally owned columns of <code>C</code> are zero outside of <code>C_global_row_range</code>). <code>D</code> should contain only the rows corresponding to <code>owned_bottom_vector_entries</code> and the columns corresponding to the global indices given by <code>D_global_column_range</code> (these do not have to be all the global indices, when it is known that the locally owned rows of <code>D</code> are zero outside of <code>D_global_column_range</code>). When shared-memory MPI parallelism is used, <code>B</code>, <code>C</code>, and <code>D</code> should all be shared memory arrays which are identical on all processes in <code>shared_comm</code> (or non-shared identical copies, but that would be an inefficient use of memory). When <code>owned_top_vector_entries</code> and/or <code>owned_bottom_vector_entries</code> are ranges that overlap between different distributed-MPI ranks, the matrices <code>A</code>, <code>B</code>, <code>C</code>, and <code>D</code> should be set up so that adding together the matrices passed on each distributed-MPI rank gives the full, global matrix (i.e. there should be no double-counting of overlapping entries, but any fraction of the overlap can be passed on any distributed rank, as long as the contributions from each distributed rank add up to the full value).</p><p><code>distributed_comm</code> and <code>shared_comm</code> are the MPI communicators to use for distributed-memory and shared-memory communications.</p><p><code>allocate_array</code> is required when <code>shared_comm</code> is passed. It should be passed a function that will be used to allocate various buffer arrays. It should return arrays with the same element type as <code>A_factorization</code>, <code>B</code>, <code>C</code>, and <code>D</code>. This is necessary as the MPI shared-memory &#39;windows&#39; (<code>MPI.Win</code>) have to be stored and (eventually) freed. The &#39;windows&#39; must be managed externally, as if they are freed by garbage collection, the freeing is not synchronized between different processes, causing errors.</p><p><code>synchronize_shared</code> can be passed a function that synchronizes all processes in <code>shared_comm</code>. This may be useful if a custom synchronization is required for debugging, etc. If it is not passed, <code>MPI.Barrier(shared_comm)</code> will be used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/johnomotani/MPISchurComplements.jl/blob/765576e9166e4412b23d3c7766dfe5ca9a60751a/src/MPISchurComplements.jl#L119-L179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MPISchurComplements.update_schur_complement!-Tuple{MPISchurComplement, Any, AbstractMatrix, AbstractMatrix, AbstractMatrix}" href="#MPISchurComplements.update_schur_complement!-Tuple{MPISchurComplement, Any, AbstractMatrix, AbstractMatrix, AbstractMatrix}"><code>MPISchurComplements.update_schur_complement!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_schur_complement!(sc::MPISchurComplement, A, B::AbstractMatrix,
                         C::AbstractMatrix, D::AbstractMatrix)</code></pre><p>Update the matrix which is being solved by <code>sc</code>.</p><p><code>A</code> will be passed to <code>lu!(sc.A_factorization, A)</code>, so should be as required by the LU implementation being used for <code>sc.A_factorization</code>.</p><p><code>B</code>, <code>C</code>, and <code>D</code> should be the same shapes, and represent the same global index ranges, as the inputs to <code>mpi_schur_complement()</code> used to construct <code>sc</code>. <code>B</code>, <code>C</code>, and <code>D</code> may be modified.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/johnomotani/MPISchurComplements.jl/blob/765576e9166e4412b23d3c7766dfe5ca9a60751a/src/MPISchurComplements.jl#L411-L423">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 30 September 2025 16:35">Tuesday 30 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
